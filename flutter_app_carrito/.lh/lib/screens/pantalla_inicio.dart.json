{
    "sourceFile": "lib/screens/pantalla_inicio.dart",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1762037445025,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1762072330383,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,50 +1,64 @@\n import '/data/datos_ejemplo.dart';\n import '/screens/pantalla_carrito.dart';\n import '/widgets/ficha_producto.dart';\n import 'package:flutter/material.dart';\n+// Importa el proveedor de carrito para gestionar el estado del carrito de compras.\n+import '/providers/carrito_provider.dart';\n+import 'package:provider/provider.dart';\n \n // Pantalla principal que muestra la lista de productos.\n class PantallaInicio extends StatelessWidget {\n   const PantallaInicio({super.key});\n \n+\n   @override\n   Widget build(BuildContext context) {\n+    // Usamos Consumer para escuchar los cambios en CarritoProvider y reconstruir el icono.\n     return Scaffold(\n       appBar: AppBar(\n         title: const Text('Mi Tienda'),\n         actions: [\n-          IconButton(\n-            icon: Stack(\n-              children: [\n-                const Icon(Icons.shopping_cart),\n-                Positioned(\n-                  right: 0,\n-                  child: Container(\n-                    padding: const EdgeInsets.all(1),\n-                    decoration: BoxDecoration(\n-                      color: Colors.red,\n-                      borderRadius: BorderRadius.circular(10),\n+          Consumer<CarritoProvider>(\n+            builder: (context, carrito, child) {\n+              return IconButton(\n+                icon: Stack(\n+                  children: [\n+                    const Icon(Icons.shopping_cart),\n+                    // Si hay artículos, muestra el contador.\n+                    if (carrito.numeroDeArticulos > 0)\n+                      Positioned(\n+                        right: 0,\n+                        child: Container(\n+                          padding: const EdgeInsets.all(1),\n+                          decoration: BoxDecoration(\n+                            color: Colors.red,\n+                            borderRadius: BorderRadius.circular(10),\n+                          ),\n+                          constraints: const BoxConstraints(\n+                            minWidth: 16,\n+                            minHeight: 16,\n+                          ),\n+                          child: Text(\n+                            carrito.numeroDeArticulos.toString(),\n+                            style: const TextStyle(\n+                              color: Colors.white,\n+                              fontSize: 10,\n+                            ),\n+                            textAlign: TextAlign.center,\n+                          ),\n+                        ),\n+                      ),\n+                  ],\n+                ),\n+                onPressed: () {\n+                  // Navega a la pantalla del carrito al pulsar el icono.\n+                  Navigator.of(context).push(\n+                    MaterialPageRoute(\n+                      builder: (context) => const PantallaCarrito(),\n                     ),\n-                    constraints: const BoxConstraints(\n-                      minWidth: 16,\n-                      minHeight: 16,\n-                    ),\n-                    child: const Text(\n-                      '0', // Valor de ejemplo\n-                      style: TextStyle(color: Colors.white, fontSize: 10),\n-                      textAlign: TextAlign.center,\n-                    ),\n-                  ),\n-                ),\n-              ],\n-            ),\n-            onPressed: () {\n-              // Navega a la pantalla del carrito al pulsar el icono.\n-              Navigator.of(context).push(\n-                MaterialPageRoute(\n-                  builder: (context) => const PantallaCarrito(),\n-                ),\n+                  );\n+                },\n               );\n             },\n           ),\n         ],\n@@ -62,9 +76,12 @@\n           final producto = productosEjemplo[index];\n           return FichaProducto(\n             producto: producto,\n             enAnadirAlCarrito: () {\n-              // La lógica para añadir al carrito se implementará en la Fase 2.\n+              // Añade el producto al carrito usando el Provider.\n+              // El 'listen: false' es importante aquí porque no necesitamos\n+              // que este widget se reconstruya cuando cambie el carrito.\n+              Provider.of<CarritoProvider>(context, listen: false).anadirProducto(producto);\n             },\n           );\n         },\n       ),\n"
                }
            ],
            "date": 1762037445025,
            "name": "Commit-0",
            "content": "import '/data/datos_ejemplo.dart';\nimport '/screens/pantalla_carrito.dart';\nimport '/widgets/ficha_producto.dart';\nimport 'package:flutter/material.dart';\n\n// Pantalla principal que muestra la lista de productos.\nclass PantallaInicio extends StatelessWidget {\n  const PantallaInicio({super.key});\n\n  @override\n  Widget build(BuildContext context) {\n    return Scaffold(\n      appBar: AppBar(\n        title: const Text('Mi Tienda'),\n        actions: [\n          IconButton(\n            icon: Stack(\n              children: [\n                const Icon(Icons.shopping_cart),\n                Positioned(\n                  right: 0,\n                  child: Container(\n                    padding: const EdgeInsets.all(1),\n                    decoration: BoxDecoration(\n                      color: Colors.red,\n                      borderRadius: BorderRadius.circular(10),\n                    ),\n                    constraints: const BoxConstraints(\n                      minWidth: 16,\n                      minHeight: 16,\n                    ),\n                    child: const Text(\n                      '0', // Valor de ejemplo\n                      style: TextStyle(color: Colors.white, fontSize: 10),\n                      textAlign: TextAlign.center,\n                    ),\n                  ),\n                ),\n              ],\n            ),\n            onPressed: () {\n              // Navega a la pantalla del carrito al pulsar el icono.\n              Navigator.of(context).push(\n                MaterialPageRoute(\n                  builder: (context) => const PantallaCarrito(),\n                ),\n              );\n            },\n          ),\n        ],\n      ),\n      body: GridView.builder(\n        padding: const EdgeInsets.all(8.0),\n        gridDelegate: const SliverGridDelegateWithFixedCrossAxisCount(\n          crossAxisCount: 2, // Dos columnas\n          childAspectRatio: 2 / 3,\n          crossAxisSpacing: 8,\n          mainAxisSpacing: 8,\n        ),\n        itemCount: productosEjemplo.length,\n        itemBuilder: (context, index) {\n          final producto = productosEjemplo[index];\n          return FichaProducto(\n            producto: producto,\n            enAnadirAlCarrito: () {\n              // La lógica para añadir al carrito se implementará en la Fase 2.\n            },\n          );\n        },\n      ),\n    );\n  }\n}\n"
        }
    ]
}